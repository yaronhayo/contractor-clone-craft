<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ez2fix | Garage Door Repair</title>
    <meta name="description" content="Garage door repair services" />
    <style>
      body { margin: 0; font-family: system-ui; }
      .loading {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        flex-direction: column;
        background: #f8f9fa;
      }
      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      .debug-info {
        position: fixed;
        top: 10px;
        right: 10px;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 10px;
        border-radius: 4px;
        font-size: 12px;
        max-width: 300px;
      }
    </style>
  </head>
  <body>
    <div id="debug-info" class="debug-info">
      Loading: Initializing...<br>
      URL: <span id="debug-url"></span><br>
      Time: <span id="debug-time"></span>
    </div>
    
    <div id="root">
      <div class="loading">
        <div class="spinner"></div>
        <div>Loading Ez2Fix Application...</div>
        <div style="font-size: 12px; color: #666; margin-top: 10px;">
          If this message persists, there may be a loading issue.
        </div>
      </div>
    </div>
    
    <script>
      console.log('=== Ez2Fix Debug: HTML Loaded ===');
      console.log('URL:', window.location.href);
      console.log('Timestamp:', new Date().toISOString());
      
      // Update debug info
      document.getElementById('debug-url').textContent = window.location.href;
      document.getElementById('debug-time').textContent = new Date().toLocaleTimeString();
      
      // Set loading timeout
      let appLoaded = false;
      
      setTimeout(function() {
        if (!appLoaded) {
          console.error('=== Ez2Fix Debug: App failed to load in 15 seconds ===');
          document.getElementById('root').innerHTML = `
            <div style="padding: 40px; text-align: center; font-family: system-ui;">
              <h2 style="color: #e74c3c;">Application Load Timeout</h2>
              <p>The React application failed to initialize within 15 seconds.</p>
              <div style="background: #ecf0f1; padding: 20px; border-radius: 4px; margin: 20px 0; text-align: left; font-size: 14px;">
                <strong>Debug Information:</strong><br>
                URL: ${window.location.href}<br>
                Time: ${new Date().toISOString()}<br>
                User Agent: ${navigator.userAgent.substring(0, 100)}...
              </div>
              <button onclick="window.location.reload()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
                Reload Page
              </button>
              <button onclick="window.location.href='/static-test'" style="background: #2ecc71; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-left: 10px;">
                Static Test
              </button>
            </div>
          `;
        }
      }, 15000);
      
      // Track when React loads
      window.addEventListener('load', function() {
        console.log('=== Ez2Fix Debug: Window Load Event ===');
      });
      
      // Catch any script errors
      window.addEventListener('error', function(e) {
        console.error('=== Ez2Fix Debug: Script Error ===', e);
        
        if (!appLoaded) {
          document.getElementById('root').innerHTML = `
            <div style="padding: 40px; text-align: center; font-family: system-ui;">
              <h2 style="color: #e74c3c;">Script Loading Error</h2>
              <p>Failed to load the application scripts.</p>
              <div style="background: #ecf0f1; padding: 20px; border-radius: 4px; margin: 20px 0; text-align: left; font-size: 14px;">
                <strong>Error Details:</strong><br>
                Message: ${e.message}<br>
                Source: ${e.filename}<br>
                Line: ${e.lineno}<br>
                Column: ${e.colno}
              </div>
              <button onclick="window.location.reload()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
                Reload Page
              </button>
            </div>
          `;
        }
      });
    </script>
    
    <script type="module" src="/src/main.tsx"></script>
    
    <script>
      // Mark app as loaded when React takes over
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.target.id === 'root' && !mutation.target.innerHTML.includes('Loading Ez2Fix Application')) {
            appLoaded = true;
            console.log('=== Ez2Fix Debug: React App Loaded ===');
            document.getElementById('debug-info').style.display = 'none';
            observer.disconnect();
          }
        });
      });
      
      observer.observe(document.getElementById('root'), { 
        childList: true, 
        subtree: true 
      });
    </script>
  </body>
</html>